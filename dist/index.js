(()=>{"use strict";var t={d:(e,n)=>{for(var r in n)t.o(n,r)&&!t.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:n[r]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e)};function e(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=function(t,e){if(!t)return;if("string"==typeof t)return n(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return n(t,e)}(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var a=0,i=function(){};return{s:i,n:function(){return a>=t.length?{done:!0}:{done:!1,value:t[a++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,l=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return s=t.done,t},e:function(t){l=!0,o=t},f:function(){try{s||null==r.return||r.return()}finally{if(l)throw o}}}}function n(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}t.d({},{A:()=>E});var r=function(t){var e=[];if(t.forEach((function(t){if(Number.isNaN(Number(t)))if(t in a){if(e.length<2)throw new Error("Insufficient operands for binary operation: ".concat(t));var n=e.pop(),r=e.pop(),o=a[t](r,n);e.push(o)}else{if(!(t in i))throw new Error("Unknown operator: ".concat(t));if(e.length<1)throw new Error("Insufficient operands for unary operation: ".concat(t));var s=e.pop(),l=i[t](s);e.push(l)}else e.push(parseFloat(t))})),1!==e.length||Number.isNaN(Number(e[0])))throw new Error("Invalid expression");return e[0]},a={"+":function(t,e){return t+e},"-":function(t,e){return t-e},"*":function(t,e){return t*e},"/":function(t,e){return t/e},"%":function(t,e){return t%e},"^":function(t,e){return Math.pow(t,e)}},i={sqrt:function(t){return Math.sqrt(t)},lg:function(t){return Math.log10(t)},ln:function(t){return Math.log(t)},n:function(t){return-t},"!":function(t){return o(t)}};function o(t){return 0===t?1:t*o(t-1)}var s=function(t){var n={"+":1,"-":1,"*":2,"/":2,"%":2,sqrt:3,lg:3,ln:3,"^":4,n:4},r=function(t){return t in n};var a=t.replace(/(^|[-+*/%^()!]|\([-+*/%^()!]*\))(-)(\(?\d+(\.\d*)?|\.\d+)/g,(function(t,e,n,r){return"-"==n?"".concat(e,"n").concat(r):e+n+r})).replace(/(Ï€)/g,(function(){return Math.PI.toFixed(5)})).match(/(\d+(\.\d*)?|\.\d+|[+\-*/%^()!]|sqrt|PI|lg|ln|\^|n)/g);if(!a)throw new Error("Invalid expression");return function(t){var a,i=[],o=[],s=e(t);try{for(s.s();!(a=s.n()).done;){var l=a.value;if(Number.isNaN(Number(l)))if(r(l)){for(;o.length&&n[o[o.length-1]]>=n[l];)i.push(o.pop());o.push(l)}else if("("===l)o.push(l);else if(")"===l){for(;o.length&&"("!==o[o.length-1];)i.push(o.pop());"("===o[o.length-1]&&o.pop()}else{if("!"!==l)throw new Error("Invalid character in expression: ".concat(l));o.push(l)}else i.push(parseFloat(l).toFixed(5))}}catch(t){s.e(t)}finally{s.f()}for(;o.length;)i.push(o.pop());return i}(a)},l=r;function u(t){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},u(t)}function c(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(a=r.key,i=void 0,i=function(t,e){if("object"!==u(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==u(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(a,"string"),"symbol"===u(i)?i:String(i)),r)}var a,i}var h=new(function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.display=document.querySelector(".calculator__screen"),this.operator="",this.hasError=!1,this.hasResult=!1}var e,n,r;return e=t,(n=[{key:"scrollInputToEnd",value:function(){var t=this.display;t.scrollLeft=t.scrollWidth}},{key:"appendDigit",value:function(t){(this.hasError||this.hasResult)&&(this.clear(),this.hasError=!1,this.hasResult=!1),this.display.value=""==this.display.value?t:this.display.value+t,this.scrollInputToEnd()}},{key:"setOperator",value:function(t){this.hasError&&(this.clear(),this.hasError=!1),["xy","x3","x2","10x","x!","+-"].indexOf(t)+1?("xy"==t&&(this.display.value+="^("),"x2"==t&&(this.display.value+="^2"),"x3"==t&&(this.display.value+="^3"),"10x"==t&&(this.hasResult?this.display.value="10^(".concat(this.display.value,")"):this.display.value+="10^("),"x!"==t&&(this.display.value+="!"),"+-"==t&&this.display.value&&("-"==this.display.value[0]?(this.display.value=this.display.value.slice(1,this.display.value.length),"("==this.display.value[0]&&")"==this.display.value[this.display.value.length-1]&&(this.display.value=this.display.value.slice(1,this.display.value.length-1))):"("!=this.display.value[0]||")"!=this.display.value[this.display.value.length-1]?this.display.value="-(".concat(this.display.value,")"):this.display.value="-".concat(this.display.value))):this.display.value+=t,this.hasResult&&(this.hasResult=!1),this.scrollInputToEnd()}},{key:"setFunction",value:function(t){this.hasError&&(this.clear(),this.hasError=!1),this.hasResult?(this.display.value="".concat(t,"(").concat(this.display.value,")"),this.hasResult=!1):this.display.value+="".concat(t,"("),this.scrollInputToEnd()}},{key:"calculate",value:function(){if(""==this.display.value)return 0;try{var t=s(this.display.value),e=l(t);return e.toString().indexOf("e")+1?(this.display.value="Too big value",this.hasError=!1,this.hasResult=!0,e):(this.display.value=parseFloat(e).toFixed(5).replace(/(\.0+|0+)$/,""),E(),this.hasError=!1,this.hasResult=!0,e)}catch(t){this.display.value="Error",E(),this.hasError=!0}}},{key:"openParenthesis",value:function(){(this.hasError||this.hasResult)&&(this.clear(),this.hasError=!1,this.hasResult=!1),this.display.value+="(",this.scrollInputToEnd()}},{key:"closeParenthesis",value:function(){(this.hasError||this.hasResult)&&(this.clear(),this.hasError=!1,this.hasResult=!1),this.display.value+=")",this.scrollInputToEnd()}},{key:"clear",value:function(){this.display.value="",this.operator=""}},{key:"leftBackspace",value:function(){this.hasError&&(this.clear(),this.hasError=!1),console.log(this.display.value.length),1==this.display.value.length?this.clear():this.display.value.length>1&&(this.display.value=this.display.value.slice(0,this.display.value.length-1),this.operator="")}}])&&c(e.prototype,n),r&&c(e,r),Object.defineProperty(e,"prototype",{writable:!1}),t}());document.addEventListener("DOMContentLoaded",(function(){var t=0;document.querySelector(".page").addEventListener("touchstart",(function(e){var n=(new Date).getTime();n-t<=50&&e.preventDefault(),t=n}))})),document.addEventListener("DOMContentLoaded",(function(){document.querySelector(".calculator").scrollIntoView({behavior:"smooth"})}));var d=document.querySelector(".calculator__screen"),p=document.querySelector(".calculator__hidden-screen"),y=parseFloat(window.getComputedStyle(d).fontSize),f=y,v=0,m="";function E(){var t=d.scrollWidth,e=d.clientWidth;if(t-1>e&&v<2)f*=.8,v++;else if(t-1<=e&&v>0){var n=f/.8,r=document.createElement("div");r.style.fontSize="".concat(n,"px"),r.style.visibility="hidden",r.style.position="absolute",r.style.top="-9999px",r.style.left="-9999px",r.style.whiteSpace="nowrap",r.textContent=d.value,document.body.appendChild(r),r.scrollWidth-1<=e&&(f=n,v--),document.body.removeChild(r)}else d.value===m&&(f=y,v=0);d.style.fontSize="".concat(f,"px"),p.style.fontSize="".concat(f,"px"),p.value=d.value,m=d.value}document.querySelectorAll(".js-digit-btn").forEach((function(t){t.addEventListener("click",(function(){var e=t.textContent;h.appendDigit(e),E()}))})),document.querySelectorAll(".js-operator-btn").forEach((function(t){t.addEventListener("click",(function(){var e=t.textContent;h.setOperator(e),E()}))})),document.querySelectorAll(".js-function-btn").forEach((function(t){t.addEventListener("click",(function(){var e=t.textContent;h.setFunction(e),E()}))})),document.querySelector(".calculator__btn_type_eq").addEventListener("click",(function(){h.calculate(),E()})),document.querySelector(".calculator__btn_type_C").addEventListener("click",(function(){h.clear(),f=y,d.style.fontSize="".concat(f,"px"),p.style.fontSize="".concat(f,"px"),v=0,E()}));var b=document.querySelector(".calculator__btn_type_lp"),g=document.querySelector(".calculator__btn_type_rp");b.addEventListener("click",(function(){h.openParenthesis(),E()})),g.addEventListener("click",(function(){h.closeParenthesis(),E()})),document.querySelector(".calculator__btn_type_bc").addEventListener("click",(function(){h.leftBackspace(),E()})),document.addEventListener("keydown",(function(t){"Enter"==t.key&&(t.preventDefault(),document.querySelector('[data-key="="]').classList.add("js-keytapped-others"),h.calculate(),E())})),document.addEventListener("keyup",(function(t){"Enter"==t.key&&(setTimeout((function(){return document.querySelector('[data-key="="]').classList.remove("js-keytapped-others")}),100),E())})),document.addEventListener("keydown",(function(t){if(!t.target.closest("input")){var e=t.key,n=document.querySelector('[data-key="'.concat(e,'"]'));e>="0"&&e<="9"?n&&(n.classList.add("js-keytapped-white"),h.appendDigit(e),E()):"Backspace"==e?(n.classList.add("js-keytapped-white"),h.leftBackspace(),E()):(n&&n.classList.add("js-keytapped-others"),["+","-","/","*","%","xy",".","x!"].indexOf(n.textContent)+1&&(h.setOperator(e),E()),"("==n.textContent&&(h.openParenthesis(),E()),")"==n.textContent&&(h.closeParenthesis(),E()),"="==n.textContent&&(h.calculate(),E()))}})),document.addEventListener("keyup",(function(t){if(!t.target.closest("input")){var e=t.key,n=document.querySelector('[data-key="'.concat(e,'"]'));e>="0"&&e<="9"||"Backspace"==e?n&&setTimeout((function(){return n.classList.remove("js-keytapped-white")}),100):n&&setTimeout((function(){return n.classList.remove("js-keytapped-others")}),100)}})),d.addEventListener("input",E),E(),d.addEventListener("keydown",(function(t){"Backspace"===t.key&&0===d.value.length&&(f=y,d.style.fontSize="".concat(f,"px"),p.style.fontSize="".concat(f,"px"),v=0)})),document.addEventListener("DOMContentLoaded",(function(){document.querySelector(".calculator__screen").addEventListener("input",(function(){this.scrollLeft=this.scrollWidth}))}))})();