(()=>{"use strict";function t(t,n){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=function(t,n){if(!t)return;if("string"==typeof t)return e(t,n);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return e(t,n)}(t))||n&&t&&"number"==typeof t.length){r&&(t=r);var i=0,a=function(){};return{s:a,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,l=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return s=t.done,t},e:function(t){l=!0,o=t},f:function(){try{s||null==r.return||r.return()}finally{if(l)throw o}}}}function e(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var n=function(t){var e=[];if(t.forEach((function(t){if(Number.isNaN(Number(t)))if(t in r){if(e.length<2)throw new Error("Insufficient operands for binary operation: ".concat(t));var n=e.pop(),a=e.pop(),o=r[t](a,n);e.push(o)}else{if(!(t in i))throw new Error("Unknown operator: ".concat(t));if(e.length<1)throw new Error("Insufficient operands for unary operation: ".concat(t));var s=e.pop(),l=i[t](s);e.push(l)}else e.push(parseFloat(t))})),1!==e.length||Number.isNaN(Number(e[0])))throw new Error("Invalid expression length".concat(e));return e[0]},r={"+":function(t,e){return t+e},"-":function(t,e){return t-e},"*":function(t,e){return t*e},"/":function(t,e){return t/e},"%":function(t,e){return t%e},"^":function(t,e){return Math.pow(t,e)}},i={sqrt:function(t){return Math.sqrt(t)},lg:function(t){return Math.log10(t)},ln:function(t){return Math.log(t)},n:function(t){return-t},"!":function(t){return a(t)}};function a(t){return 0===t?1:t*a(t-1)}var o=function(e){var n={"+":1,"-":1,"*":2,"/":2,"%":2,sqrt:4,lg:4,ln:4,"^":4,"!":4,n:4},r=function(t){return t in n};var i=e.replace(/(^|[-+*/%^(]|\([-+*/%^(]*\))(-)(\(?\d+(\.\d*)?|\.\d+)/g,(function(t,e,n,r){return"-"==n?"".concat(e,"n").concat(r):e+n+r})).replace(/(Ï€)/g,(function(){return Math.PI.toFixed(5)})).match(/(\d+(\.\d*)?|\.\d+|[+\-*/%^()!]|sqrt|PI|lg|ln|\^|n)/g);if(!i)throw new Error("Invalid expression ".concat(i));return function(e){var i,a=[],o=[],s=t(e);try{for(s.s();!(i=s.n()).done;){var l=i.value;if(Number.isNaN(Number(l)))if(r(l)){for(;o.length&&n[o[o.length-1]]>=n[l];)a.push(o.pop());o.push(l)}else if("("===l)o.push(l);else if(")"===l){for(;o.length&&"("!==o[o.length-1];)a.push(o.pop());"("===o[o.length-1]&&o.pop()}else{if("!"!==l)throw new Error("Invalid character in expression: ".concat(l));o.push(l)}else a.push(parseFloat(l).toFixed(5))}}catch(t){s.e(t)}finally{s.f()}for(;o.length;)a.push(o.pop());return a}(i)},s=n;function l(t){return l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},l(t)}function u(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(i=r.key,a=void 0,a=function(t,e){if("object"!==l(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==l(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(i,"string"),"symbol"===l(a)?a:String(a)),r)}var i,a}var c,h,d=new(function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.display=document.querySelector(".calculator__screen"),this.operator="",this.hasError=!1,this.hasResult=!1}var e,n,r;return e=t,(n=[{key:"scrollInputToEnd",value:function(){var t=this.display;t.scrollLeft=t.scrollWidth}},{key:"appendDigit",value:function(t){(this.hasError||this.hasResult)&&(this.clear(),this.hasError=!1,this.hasResult=!1),this.display.value=""==this.display.value?t:this.display.value+t,this.scrollInputToEnd()}},{key:"setOperator",value:function(t){this.hasError&&(this.clear(),this.hasError=!1),["xy","x3","x2","10x","x!","+-"].indexOf(t)+1?("xy"==t&&(this.display.value+="^("),"x2"==t&&(this.display.value+="^2"),"x3"==t&&(this.display.value+="^3"),"10x"==t&&(this.hasResult?this.display.value="10^(".concat(this.display.value,")"):this.display.value+="10^("),"x!"==t&&(this.display.value+="!"),"+-"==t&&this.display.value&&("-"==this.display.value[0]?(this.display.value=this.display.value.slice(1,this.display.value.length),"("==this.display.value[0]&&")"==this.display.value[this.display.value.length-1]&&(this.display.value=this.display.value.slice(1,this.display.value.length-1))):"("!=this.display.value[0]||")"!=this.display.value[this.display.value.length-1]?this.display.value="-(".concat(this.display.value,")"):this.display.value="-".concat(this.display.value))):this.display.value+=t,this.hasResult&&(this.hasResult=!1),this.scrollInputToEnd()}},{key:"setFunction",value:function(t){this.hasError&&(this.clear(),this.hasError=!1),this.hasResult?(this.display.value="".concat(t,"(").concat(this.display.value,")"),this.hasResult=!1):this.display.value+="".concat(t,"("),this.scrollInputToEnd()}},{key:"calculate",value:function(){if(""==this.display.value)return 0;try{var t=o(this.display.value),e=s(t);return this.display.value=e,e.toString().indexOf("e")+1?(this.display.value="Too big value",this.hasError=!1,this.hasResult=!0,e):(this.display.value=parseFloat(e).toFixed(5).replace(/(\.0+|0+)$/,""),g(),this.hasError=!1,this.hasResult=!0,e)}catch(t){this.display.value="error",g(),this.hasError=!0}}},{key:"openParenthesis",value:function(){(this.hasError||this.hasResult)&&(this.clear(),this.hasError=!1,this.hasResult=!1),this.display.value+="(",this.scrollInputToEnd()}},{key:"closeParenthesis",value:function(){(this.hasError||this.hasResult)&&(this.clear(),this.hasError=!1,this.hasResult=!1),this.display.value+=")",this.scrollInputToEnd()}},{key:"clear",value:function(){this.hasError=!1,this.hasResult=!1,this.display.value="",this.operator=""}},{key:"leftBackspace",value:function(){this.hasError&&(this.clear(),this.hasError=!1),console.log(this.display.value.length),1==this.display.value.length?this.clear():this.display.value.length>1&&(this.display.value=this.display.value.slice(0,this.display.value.length-1),this.operator="")}}])&&u(e.prototype,n),r&&u(e,r),Object.defineProperty(e,"prototype",{writable:!1}),t}()),p=document.querySelector(".calculator__screen"),y=document.querySelector(".calculator__hidden-screen"),f=parseFloat(window.getComputedStyle(p).fontSize),v=f,m=0,E="";function g(){var t=p.scrollWidth,e=p.clientWidth;if(t-1>e&&m<2)v*=.8,m++;else if(t-1<=e&&m>0){var n=v/.8,r=document.createElement("div");r.style.fontSize="".concat(n,"px"),r.style.visibility="hidden",r.style.position="absolute",r.style.top="-9999px",r.style.left="-9999px",r.style.whiteSpace="nowrap",r.textContent=p.value,document.body.appendChild(r),r.scrollWidth-1<=e&&(v=n,m--),document.body.removeChild(r)}else p.value===E&&(v=f,m=0);p.style.fontSize="".concat(v,"px"),y.style.fontSize="".concat(v,"px"),y.value=p.value,E=p.value}g(),document.querySelector(".calculator__btn_type_bc").addEventListener("click",(function(){d.leftBackspace(),g()})),document.querySelector(".calculator__btn_type_C").addEventListener("click",(function(){d.clear(),v=f,p.style.fontSize="".concat(v,"px"),y.style.fontSize="".concat(v,"px"),m=0,g()})),document.querySelectorAll(".js-digit-btn").forEach((function(t){t.addEventListener("click",(function(){var e=t.textContent;d.appendDigit(e),g()}))})),document.querySelector(".calculator__btn_type_eq").addEventListener("click",(function(){d.calculate(),g()})),document.querySelectorAll(".js-function-btn").forEach((function(t){t.addEventListener("click",(function(){var e=t.textContent;d.setFunction(e),g()}))})),document.querySelectorAll(".js-operator-btn").forEach((function(t){t.addEventListener("click",(function(){var e=t.textContent;d.setOperator(e),g()}))})),c=document.querySelector(".calculator__btn_type_lp"),h=document.querySelector(".calculator__btn_type_rp"),c.addEventListener("click",(function(){d.openParenthesis(),g()})),h.addEventListener("click",(function(){d.closeParenthesis(),g()})),document.addEventListener("keydown",(function(t){if(!t.target.closest("input")){var e=t.key,n=document.querySelector('[data-key="'.concat(e,'"]'));e>="0"&&e<="9"?n&&(n.classList.add("js-keytapped-white"),d.appendDigit(e),g()):"Backspace"==e?(n.classList.add("js-keytapped-white"),d.leftBackspace(),g()):(n&&n.classList.add("js-keytapped-others"),["+","-","/","*","%","xy",".","x!"].indexOf(n.textContent)+1&&(d.setOperator(e),g()),"("==n.textContent&&(d.openParenthesis(),g()),")"==n.textContent&&(d.closeParenthesis(),g()),"="==n.textContent&&(d.calculate(),g()))}})),document.addEventListener("keyup",(function(t){if(!t.target.closest("input")){var e=t.key,n=document.querySelector('[data-key="'.concat(e,'"]'));e>="0"&&e<="9"||"Backspace"==e?n&&setTimeout((function(){return n.classList.remove("js-keytapped-white")}),100):n&&setTimeout((function(){return n.classList.remove("js-keytapped-others")}),100)}})),document.addEventListener("keydown",(function(t){"Enter"==t.key&&(t.preventDefault(),document.querySelector('[data-key="="]').classList.add("js-keytapped-others"),d.calculate(),g())})),document.addEventListener("keyup",(function(t){"Enter"==t.key&&(setTimeout((function(){return document.querySelector('[data-key="="]').classList.remove("js-keytapped-others")}),100),g())})),p.addEventListener("input",g),g(),p.addEventListener("keydown",(function(t){"Backspace"===t.key&&0===p.value.length&&(v=f,p.style.fontSize="".concat(v,"px"),y.style.fontSize="".concat(v,"px"),m=0)})),document.addEventListener("DOMContentLoaded",(function(){document.querySelector(".calculator__screen").addEventListener("input",(function(){this.scrollLeft=this.scrollWidth}))})),document.addEventListener("DOMContentLoaded",(function(){document.querySelector(".calculator").scrollIntoView({behavior:"smooth"})})),document.addEventListener("DOMContentLoaded",(function(){var t=0;document.querySelector(".page").addEventListener("touchstart",(function(e){var n=(new Date).getTime();n-t<=50&&e.preventDefault(),t=n}))}))})();